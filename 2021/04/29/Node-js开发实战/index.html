<!DOCTYPE html><html lang="zh"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,minimal-ui"><meta name="renderer" content="webkit"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=no,email=no,adress=no"><meta name="theme-color" content="#000000"><meta http-equiv="window-target" content="_top"><title>Node.js开发实战 | 月亮的部落格</title><meta name="description" content="第一章 1 课程介绍 1-1 使用nodejs过程中遇到的问题 1-2 nodejs为什么值得学习? 1-3 使用nodejs的难点在哪里?   3 nodejs是什么? 4 nodejs可以用来做什么? 4-1 由什么需求决定的? 以腾讯视频网页版为例 4-2 构建工作流 (automate and enhance your workflow)-nodejs现在被广泛运用的另一个场景 4-3"><meta property="og:type" content="article"><meta property="og:title" content="Node.js开发实战"><meta property="og:url" content="https://scarlett9354.github.io/2021/04/29/Node-js%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98/index.html"><meta property="og:site_name" content="Hexo"><meta property="og:description" content="第一章 1 课程介绍 1-1 使用nodejs过程中遇到的问题 1-2 nodejs为什么值得学习? 1-3 使用nodejs的难点在哪里?   3 nodejs是什么? 4 nodejs可以用来做什么? 4-1 由什么需求决定的? 以腾讯视频网页版为例 4-2 构建工作流 (automate and enhance your workflow)-nodejs现在被广泛运用的另一个场景 4-3"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://scarlett9354.github.io/2021/04/29/Node-js%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98/01.jpg"><meta property="og:image" content="https://scarlett9354.github.io/2021/04/29/Node-js%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98/02.jpg"><meta property="og:image" content="https://scarlett9354.github.io/2021/04/29/Node-js%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98/03.jpg"><meta property="og:image" content="https://scarlett9354.github.io/2021/04/29/Node-js%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98/04.jpg"><meta property="og:image" content="https://scarlett9354.github.io/2021/04/29/Node-js%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98/05.jpg"><meta property="og:image" content="https://scarlett9354.github.io/2021/04/29/Node-js%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98/06.jpg"><meta property="og:image" content="https://scarlett9354.github.io/2021/04/29/Node-js%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98/07.jpg"><meta property="og:image" content="https://scarlett9354.github.io/2021/04/29/Node-js%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98/08.jpg"><meta property="og:image" content="https://scarlett9354.github.io/2021/04/29/Node-js%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98/09.jpg"><meta property="og:image" content="https://scarlett9354.github.io/2021/04/29/Node-js%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98/10.jpg"><meta property="og:image" content="https://scarlett9354.github.io/2021/04/29/Node-js%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98/11.jpg"><meta property="og:image" content="https://scarlett9354.github.io/2021/04/29/Node-js%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98/12.jpg"><meta property="og:image" content="https://scarlett9354.github.io/2021/04/29/Node-js%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98/13.jpg"><meta property="og:image" content="https://scarlett9354.github.io/2021/04/29/Node-js%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98/14.jpg"><meta property="og:image" content="https://scarlett9354.github.io/2021/04/29/Node-js%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98/15.jpg"><meta property="og:image" content="https://scarlett9354.github.io/2021/04/29/Node-js%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98/16.jpg"><meta property="og:image" content="https://scarlett9354.github.io/2021/04/29/Node-js%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98/17.jpg"><meta property="og:image" content="https://scarlett9354.github.io/2021/04/29/Node-js%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98/18.jpg"><meta property="og:image" content="https://scarlett9354.github.io/2021/04/29/Node-js%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98/19.jpg"><meta property="og:image" content="https://scarlett9354.github.io/2021/04/29/Node-js%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98/20.jpg"><meta property="article:published_time" content="2021-04-29T07:33:16.000Z"><meta property="article:modified_time" content="2021-05-11T03:40:18.884Z"><meta property="article:author" content="John Doe"><meta property="article:tag" content="Node.js"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://scarlett9354.github.io/2021/04/29/Node-js%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98/01.jpg"><link rel="canonical" href="https://scarlett9354.github.io/2021/04/29/Node-js%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98/index.html"><link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml"><link rel="icon" href="/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><meta name="generator" content="Hexo 5.4.0"></head><body class="main-center" itemscope itemtype="http://schema.org/WebPage"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="slimContent"><div class="navbar-header"><div class="profile-block text-center"><a id="avatar" href="https://github.com/scarlett9354" target="_blank"><img class="img-circle img-rotate" src="/images/avatar.jpg" width="200" height="200"></a><h2 id="name" class="hidden-xs hidden-sm">月亮和水蜜桃</h2><h3 id="title" class="hidden-xs hidden-sm hidden-md"></h3><small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> 北京</small></div><div class="search" id="search-form-wrap"><form class="search-form sidebar-form"><div class="input-group"><input type="text" class="search-form-input form-control" placeholder="搜索"> <span class="input-group-btn"><button type="submit" class="search-form-submit btn btn-flat" onclick="return!1"><i class="icon icon-search"></i></button></span></div></form><div class="ins-search"><div class="ins-search-mask"></div><div class="ins-search-container"><div class="ins-input-wrapper"><input type="text" class="ins-search-input" placeholder="想要查找什么..." x-webkit-speech> <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button></div><div class="ins-section-wrapper"><div class="ins-section-container"></div></div></div></div></div><button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button></div><nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation"><ul class="nav navbar-nav main-nav menu-highlight"><li class="menu-item menu-item-home"><a href="/."><i class="icon icon-home-fill"></i> <span class="menu-title">首页</span></a></li><li class="menu-item menu-item-archives"><a href="/archives"><i class="icon icon-archives-fill"></i> <span class="menu-title">归档</span></a></li><li class="menu-item menu-item-categories"><a href="/categories"><i class="icon icon-folder"></i> <span class="menu-title">分类</span></a></li><li class="menu-item menu-item-tags"><a href="/tags"><i class="icon icon-tags"></i> <span class="menu-title">标签</span></a></li><li class="menu-item menu-item-repository"><a href="/repository"><i class="icon icon-project"></i> <span class="menu-title">项目</span></a></li><li class="menu-item menu-item-books"><a href="/books"><i class="icon icon-book-fill"></i> <span class="menu-title">书单</span></a></li><li class="menu-item menu-item-links"><a href="/links"><i class="icon icon-friendship"></i> <span class="menu-title">友链</span></a></li><li class="menu-item menu-item-about"><a href="/about"><i class="icon icon-cup-fill"></i> <span class="menu-title">关于</span></a></li></ul><ul class="social-links"><li><a href="https://github.com/scarlett9354" target="_blank" title="Github" data-toggle="tooltip" data-placement="top"><i class="icon icon-github"></i></a></li></ul></nav></div></header><aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar"><div class="slimContent"><div class="widget"><h3 class="widget-title">公告</h3><div class="widget-body"><div id="board"><div class="content"><p>欢迎交流与分享经验!</p></div></div></div></div><div class="widget"><h3 class="widget-title">分类</h3><div class="widget-body"><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/ES6-7/">ES6-7</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/HTTP/">HTTP</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Node-js/">Node.js</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/React/">React</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/TypeScript/">TypeScript</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Vue/">Vue</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/webpack/">webpack</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%B7%A5%E4%BD%9C%E7%9B%B8%E5%85%B3/">工作相关</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/">性能优化</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%AE%97%E6%B3%95/">算法</a><span class="category-list-count">1</span></li></ul></div></div><div class="widget"><h3 class="widget-title">标签</h3><div class="widget-body"><ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/ES6/" rel="tag">ES6</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ES7/" rel="tag">ES7</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Node-js/" rel="tag">Node.js</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/React/" rel="tag">React</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/React-Hook/" rel="tag">React Hook</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/React16-4/" rel="tag">React16.4</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TypeScript/" rel="tag">TypeScript</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/http/" rel="tag">http</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/https/" rel="tag">https</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vue/" rel="tag">vue</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vue-router/" rel="tag">vue-router</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vuex/" rel="tag">vuex</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/webpack/" rel="tag">webpack</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" rel="tag">性能优化</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a><span class="tag-list-count">1</span></li></ul></div></div><div class="widget"><h3 class="widget-title">标签云</h3><div class="widget-body tagcloud"><a href="/tags/ES6/" style="font-size:13.33px">ES6</a> <a href="/tags/ES7/" style="font-size:13px">ES7</a> <a href="/tags/Node-js/" style="font-size:13px">Node.js</a> <a href="/tags/React/" style="font-size:14px">React</a> <a href="/tags/React-Hook/" style="font-size:13.67px">React Hook</a> <a href="/tags/React16-4/" style="font-size:13px">React16.4</a> <a href="/tags/TypeScript/" style="font-size:13.67px">TypeScript</a> <a href="/tags/http/" style="font-size:13px">http</a> <a href="/tags/https/" style="font-size:13px">https</a> <a href="/tags/vue/" style="font-size:13.33px">vue</a> <a href="/tags/vue-router/" style="font-size:13px">vue-router</a> <a href="/tags/vuex/" style="font-size:13px">vuex</a> <a href="/tags/webpack/" style="font-size:13.33px">webpack</a> <a href="/tags/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" style="font-size:13px">性能优化</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size:13px">算法</a></div></div><div class="widget"><h3 class="widget-title">归档</h3><div class="widget-body"><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/10/">十月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/03/">三月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">八月 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">七月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">六月 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">五月 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">四月 2021</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">三月 2021</a><span class="archive-list-count">1</span></li></ul></div></div><div class="widget"><h3 class="widget-title">最新文章</h3><div class="widget-body"><ul class="recent-post-list list-unstyled no-thumbnail"><li><div class="item-inner"><p class="item-category"></p><p class="item-title"><a href="/2022/10/26/%E8%B4%A2%E5%AF%8C%E8%87%AA%E7%94%B1/" class="title">财富自由</a></p><p class="item-date"><time datetime="2022-10-26T08:29:50.000Z" itemprop="datePublished">2022-10-26</time></p></div></li><li><div class="item-inner"><p class="item-category"><a class="category-link" href="/categories/React/">React</a></p><p class="item-title"><a href="/2022/03/09/%E7%B2%BE%E9%80%9AReactHook%E5%BC%80%E5%8F%91/" class="title">精通React Hook开发</a></p><p class="item-date"><time datetime="2022-03-09T07:17:53.000Z" itemprop="datePublished">2022-03-09</time></p></div></li><li><div class="item-inner"><p class="item-category"><a class="category-link" href="/categories/%E7%AE%97%E6%B3%95/">算法</a></p><p class="item-title"><a href="/2021/08/20/%E5%89%8D%E7%AB%AFLeetCode%E9%A2%98%E7%9B%AE/" class="title">前端LeetCode题目</a></p><p class="item-date"><time datetime="2021-08-20T02:57:23.000Z" itemprop="datePublished">2021-08-20</time></p></div></li><li><div class="item-inner"><p class="item-category"><a class="category-link" href="/categories/React/">React</a></p><p class="item-title"><a href="/2021/08/19/React17-ReactHook-TS4%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%EF%BC%8C%E4%BB%BFJira%E4%BC%81%E4%B8%9A%E7%BA%A7%E9%A1%B9%E7%9B%AE-%E4%B8%89/" class="title">React17+React Hook+TS4 最佳实践，仿 Jira 企业级项目(三)</a></p><p class="item-date"><time datetime="2021-08-19T08:42:53.000Z" itemprop="datePublished">2021-08-19</time></p></div></li><li><div class="item-inner"><p class="item-category"><a class="category-link" href="/categories/React/">React</a></p><p class="item-title"><a href="/2021/08/03/React17-ReactHook-TS4%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%EF%BC%8C%E4%BB%BFJira%E4%BC%81%E4%B8%9A%E7%BA%A7%E9%A1%B9%E7%9B%AE-%E4%BA%8C/" class="title">React17+React Hook+TS4 最佳实践，仿 Jira 企业级项目(二)</a></p><p class="item-date"><time datetime="2021-08-03T09:02:26.000Z" itemprop="datePublished">2021-08-03</time></p></div></li></ul></div></div></div></aside><main class="main" role="main"><div class="content"><article id="post-Node-js开发实战" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting"><div class="article-header"><h1 class="article-title" itemprop="name">Node.js开发实战</h1><div class="article-meta"><span class="article-date"><i class="icon icon-calendar-check"></i> <a href="/2021/04/29/Node-js%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98/" class="article-date"><time datetime="2021-04-29T07:33:16.000Z" itemprop="datePublished">2021-04-29</time> </a></span><span class="article-category"><i class="icon icon-folder"></i> <a class="article-category-link" href="/categories/Node-js/">Node.js</a> </span><span class="article-tag"><i class="icon icon-tags"></i> <a class="article-tag-link-link" href="/tags/Node-js/" rel="tag">Node.js</a> </span><span class="post-comment"><i class="icon icon-comment"></i> <a href="/2021/04/29/Node-js%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98/#comments" class="article-comment-link">评论</a></span></div></div><div class="article-entry marked-body" itemprop="articleBody"><ul><li><a href="#%E7%AC%AC%E4%B8%80%E7%AB%A0">第一章</a><ul><li><a href="#1-%E8%AF%BE%E7%A8%8B%E4%BB%8B%E7%BB%8D">1 课程介绍</a><ul><li><a href="#1-1-%E4%BD%BF%E7%94%A8nodejs%E8%BF%87%E7%A8%8B%E4%B8%AD%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98">1-1 使用nodejs过程中遇到的问题</a></li><li><a href="#1-2-nodejs%E4%B8%BA%E4%BB%80%E4%B9%88%E5%80%BC%E5%BE%97%E5%AD%A6%E4%B9%A0">1-2 nodejs为什么值得学习?</a></li><li><a href="#1-3-%E4%BD%BF%E7%94%A8nodejs%E7%9A%84%E9%9A%BE%E7%82%B9%E5%9C%A8%E5%93%AA%E9%87%8C">1-3 使用nodejs的难点在哪里?</a></li></ul></li><li><a href="#3-nodejs%E6%98%AF%E4%BB%80%E4%B9%88">3 nodejs是什么?</a></li><li><a href="#4-nodejs%E5%8F%AF%E4%BB%A5%E7%94%A8%E6%9D%A5%E5%81%9A%E4%BB%80%E4%B9%88">4 nodejs可以用来做什么?</a><ul><li><a href="#4-1-%E7%94%B1%E4%BB%80%E4%B9%88%E9%9C%80%E6%B1%82%E5%86%B3%E5%AE%9A%E7%9A%84-%E4%BB%A5%E8%85%BE%E8%AE%AF%E8%A7%86%E9%A2%91%E7%BD%91%E9%A1%B5%E7%89%88%E4%B8%BA%E4%BE%8B">4-1 由什么需求决定的? 以腾讯视频网页版为例</a></li><li><a href="#4-2-%E6%9E%84%E5%BB%BA%E5%B7%A5%E4%BD%9C%E6%B5%81-automate-and-enhance-your-workflow-nodejs%E7%8E%B0%E5%9C%A8%E8%A2%AB%E5%B9%BF%E6%B3%9B%E8%BF%90%E7%94%A8%E7%9A%84%E5%8F%A6%E4%B8%80%E4%B8%AA%E5%9C%BA%E6%99%AF">4-2 构建工作流 (automate and enhance your workflow)-nodejs现在被广泛运用的另一个场景</a></li><li><a href="#4-3-%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7visual-studio-code-nodejs%E7%9A%84%E7%AC%AC%E4%B8%89%E4%B8%AA%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF">4-3 开发工具visual studio code-nodejs的第三个应用场景</a></li><li><a href="#4-4-%E6%B8%B8%E6%88%8F-wayward">4-4 游戏-wayward</a></li><li><a href="#4-4-%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%BA%94%E7%94%A8-twitch-tv">4-4 客户端应用-twitch-tv</a></li></ul></li><li><a href="#5-%E8%AF%BE%E7%A8%8B%E5%AE%9E%E6%88%98%E9%A1%B9%E7%9B%AE%E4%BB%8B%E7%BB%8D">5 课程实战项目介绍</a></li></ul></li><li><a href="#%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E6%8A%80%E6%9C%AF%E9%A2%84%E7%A0%94%E7%AF%87">第二章 技术预研篇</a><ul><li><a href="#6-%E4%BB%80%E4%B9%88%E6%98%AF%E6%8A%80%E6%9C%AF%E9%A2%84%E7%A0%94">6 什么是技术预研?</a></li><li><a href="#7-nodejs%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85">7 nodejs开发环境安装</a></li><li><a href="#8-%E7%AC%AC%E4%B8%80%E4%B8%AAnodejs%E7%A8%8B%E5%BA%8F-%E7%9F%B3%E5%A4%B4%E5%89%AA%E5%88%80%E5%B8%83%E6%B8%B8%E6%88%8F">8 第一个nodejs程序-石头剪刀布游戏</a><ul><li><a href="#8-1-%E5%89%8D%E8%A8%80">8-1 前言</a></li><li><a href="#8-2-%E5%88%A9%E7%94%A8process-argv%E6%AD%A3%E5%BC%8F%E7%BC%96%E5%86%99%E7%9F%B3%E5%A4%B4%E5%89%AA%E5%88%80%E5%B8%83%E6%B8%B8%E6%88%8F">8-2 利用process-argv正式编写石头剪刀布游戏</a></li></ul></li><li><a href="#9-%E6%A8%A1%E5%9D%97-commonjs%E8%A7%84%E8%8C%83">9 模块-commonjs规范</a><ul><li><a href="#9-1-commonjs%E8%A7%84%E8%8C%83%E7%9A%84%E4%BD%BF%E7%94%A8%E8%BF%87%E7%A8%8B">9-1 commonjs规范的使用过程</a></li></ul></li><li><a href="#10-%E6%A8%A1%E5%9D%97-%E4%BD%BF%E7%94%A8%E6%A8%A1%E5%9D%97%E8%A7%84%E8%8C%83%E6%94%B9%E9%80%A0%E7%9F%B3%E5%A4%B4%E5%89%AA%E5%88%80%E5%B8%83%E6%B8%B8%E6%88%8F">10 模块-使用模块规范改造石头剪刀布游戏</a><ul><li><a href="#10-1-%E6%94%B9%E9%80%A0%E7%9F%B3%E5%A4%B4%E5%89%AA%E5%88%80%E5%B8%83%E6%B8%B8%E6%88%8F">10-1 改造石头剪刀布游戏</a></li></ul></li><li><a href="#11-%E6%A8%A1%E5%9D%97-npm">11 模块-npm</a><ul><li><a href="#11-1-npm%E4%BB%8B%E7%BB%8D">11-1 npm介绍</a></li><li><a href="#11-2-%E6%80%8E%E4%B9%88%E4%BD%BF%E7%94%A8npm%E5%8C%85%E5%91%A2">11-2 怎么使用npm包呢?</a></li></ul></li><li><a href="#12-%E6%A8%A1%E5%9D%97-nodejs%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97">12 模块-nodejs内置模块</a><ul><li><a href="#12-1-nodejs%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97">12-1 nodejs内置模块</a></li><li><a href="#12-2-%E5%89%96%E6%9E%90nodejs%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97">12-2 剖析nodejs内置模块</a></li><li><a href="#12-3-event-emitter">12-3 event-emitter</a></li><li><a href="#12-4-%E6%80%BB%E7%BB%93">12-4 总结</a></li></ul></li><li><a href="#13-%E5%BC%82%E6%AD%A5-%E9%9D%9E%E9%98%BB%E5%A1%9Ei-o">13 异步-非阻塞i /o</a><ul><li><a href="#13-1-%E9%9D%9E%E9%98%BB%E5%A1%9Ei-o%E7%9A%84%E5%AE%9A%E4%B9%89">13-1 非阻塞i /o的定义</a></li><li><a href="#13-2-%E9%9D%9E%E9%98%BB%E5%A1%9Ei-o%E4%BB%A3%E7%A0%81%E6%BC%94%E7%A4%BA">13-2 非阻塞i /o代码演示</a></li><li><a href="#13-3-nodejs%E6%9E%B6%E6%9E%84%E5%9B%BE%E8%AE%B2%E8%A7%A3">13-3 nodejs架构图讲解</a></li></ul></li><li><a href="#14-%E5%BC%82%E6%AD%A5-%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B%E4%B9%8Bcallback">14 异步-异步编程之callback</a><ul><li><a href="#14-1-%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0">14-1 回调函数</a></li></ul></li></ul></li></ul><h1 id="第一章"><a href="#第一章" class="headerlink" title="第一章"></a>第一章</h1><h2 id="1-课程介绍"><a href="#1-课程介绍" class="headerlink" title="1 课程介绍"></a>1 课程介绍</h2><h3 id="1-1-使用nodejs过程中遇到的问题"><a href="#1-1-使用nodejs过程中遇到的问题" class="headerlink" title="1-1 使用nodejs过程中遇到的问题"></a>1-1 使用nodejs过程中遇到的问题</h3><ol><li>Node.js程序运行不稳定，经常出现服务不可用的情况</li><li>Node.js程序运行效率低</li><li>前端同学对服务端技术不熟悉，培训困难，推广受阻</li></ol><h3 id="1-2-nodejs为什么值得学习"><a href="#1-2-nodejs为什么值得学习" class="headerlink" title="1-2 nodejs为什么值得学习?"></a>1-2 nodejs为什么值得学习?</h3><ul><li>Node.js拥有广大的JavaScript程序员基础，并且完全开源，所以它拥有一个强大的开发者社区，依靠繁荣的社区力量，现在已经发展出成熟的技术体系以及庞大的生态。<br>它被广泛应用在Web服务、开发工作流、客户端应用等领域，其中在Web服务开发领域，业界对它的接受程度是最高的。<br>通常它会被用来做一个BFF层，即Backend For Frontend（服务于前端的后端），通俗地说，就是一个专门为前端业务提供数据的后端程序。这类程序的特点是，不需要太强的服务器运算能力，但对程序的灵活性有较高的要求。这两个特点正好与Node.js的优势相吻合。</li><li>在Web服务开发领域搭建一个Node.js BFF层是有很大好处的：<ol><li>对于Web业务本身来说，Node.js现在是最适合用来做BFF层的一门技术。<br>有一个Node.js BFF层，能让前端有能力自由组装后台数据，这样可以减少大量的业务沟通成本，加快业务的迭代速度；同时，前端工程师能自主决定前端与后台通讯的方式，也让前端工程师有了更多能力着手于Web应用的性能优化。</li><li>对于后端和运维工程师来说，Node.js BFF层的搭建，绝对不是一个光靠前端工程师就能完成的事情，在搭建过程中涉及到的RPC调用、系统运维等场景，都需要后端和运维的紧密配合。<br>通过搭建BFF层，除了后续能大幅减少自己在繁重业务中的工作量之外，还可以大大提升自己在架构领域的知识经验。</li><li>对于前端工程师自身来说，Node.js虽然是一门非浏览器端的技术，但是它基于JavaScript的环境，能让前端工程师快速上手。<br>我们可以经由Node.js涉足数据库、操作系统、人工智能等领域，让前端工程师不再因为技术的壁垒将眼光局限在浏览器这一个环境内。</li></ol></li></ul><h3 id="1-3-使用nodejs的难点在哪里"><a href="#1-3-使用nodejs的难点在哪里" class="headerlink" title="1-3 使用nodejs的难点在哪里?"></a>1-3 使用nodejs的难点在哪里?</h3><ul><li>Node.js这门技术除了JavaScript之外，其他地方和浏览器技术几乎毫无交集，即使是数据结构、设计模式等等程序员通用技巧，也都有侧重点不一样的部分。<br>比如，在使用Node.js的过程中，前端工程师需要了解诸如RPC调用、进程管理等非浏览器端的知识。</li><li>除此之外，在推广Node.js的过程中，可能还会遇到产品、后台、运维甚至老板等不同角色的质疑，导致前端使用Node.js开展业务会碰上各种各样的阻力。</li><li>因此，除了补充必要的后端开发知识和系统运维知识外，我们还需要对Node.js的优缺点、它能给业务带来的价值都有非常深入的理解，才能说服他人配合你，完成从前端到后台的一整套项目开发。</li></ul><h2 id="3-nodejs是什么"><a href="#3-nodejs是什么" class="headerlink" title="3 nodejs是什么?"></a>3 nodejs是什么?</h2><ul><li>根据官网的话：<br>Node.js是一个基于<strong>Chrome V8引擎</strong>的JavaScript运行环境。<br>Node.js使用了一个<strong>事件驱动</strong>、<strong>非阻塞式I/O</strong>的模型，使其轻量又高效。<br>其实没必要知道这些！！！</li><li>在Node.js里运行JavaScript跟在Chrome里运行JavaScript有什么不同？Chrome浏览器用的是同样的JavaScript引擎和模型。<br>其实，在Node.js里写JS和在Chrome里写JS，<strong>几乎没有不一样</strong>。</li><li>那么不一样在哪里呢？<ol><li>Node.js没有浏览器API，即document、window等。</li><li>加了许多Node.js API，比如文件系统、进程等等。</li></ol></li><li>对于开发者来说，Node.js：<ol><li>你在Chrome里写JavaScript控制的是<strong>浏览器</strong></li><li>Node.js让你用类似的方式，控制<strong>整个计算机</strong>。</li></ol></li><li>Node.js的真谛（即官网的定义），需要你在Node.js的学习过程中慢慢理解。</li></ul><h2 id="4-nodejs可以用来做什么"><a href="#4-nodejs可以用来做什么" class="headerlink" title="4 nodejs可以用来做什么?"></a>4 nodejs可以用来做什么?</h2><h3 id="4-1-由什么需求决定的-以腾讯视频网页版为例"><a href="#4-1-由什么需求决定的-以腾讯视频网页版为例" class="headerlink" title="4-1 由什么需求决定的? 以腾讯视频网页版为例"></a>4-1 由什么需求决定的? 以<a target="_blank" rel="noopener" href="https://v.qq.com/">腾讯视频网页版</a>为例</h3><ul><li>搜索引擎的优化 + 首屏速度优化 = 服务端渲染<ol><li>需要实现搜索引擎的优化；</li><li>要实现网页首屏的加速。</li></ol>这两个需求就决定了，需要做个服务端的渲染，就决定采用了Node.js。</li><li>服务端渲染 + 前后端同构 = Node.js<br>同一模板要考虑前后端复用问题，即前后端可以采用同一套代码，所以为了达到服务端渲染和前后端同构，最后决定采用Node.js。</li></ul><h3 id="4-2-构建工作流-automate-and-enhance-your-workflow-nodejs现在被广泛运用的另一个场景"><a href="#4-2-构建工作流-automate-and-enhance-your-workflow-nodejs现在被广泛运用的另一个场景" class="headerlink" title="4-2 构建工作流 (automate and enhance your workflow)-nodejs现在被广泛运用的另一个场景"></a>4-2 构建工作流 (automate and enhance your workflow)-nodejs现在被广泛运用的另一个场景</h3><ul><li><p>这里有两个典型的工具：gulp<a target="_blank" rel="noopener" href="https://www.gulpjs.com.cn/">官网</a>和webpack<a target="_blank" rel="noopener" href="https://www.webpackjs.com/">官网</a></p></li><li><p>gulp官网上的一个简单例子：</p><img src="01.jpg" alt="01" style="zoom:67%"><p>这个例子具体做了什么？<br>它可以给html、css、js文件各做一些预处理，比如html任务，网页对模板做了个预编译；css任务表示样式是用less语言编写，可以通过gulp编译成css，再放到它们的生产目录上；js任务表示有很多js，通过gulp打包拼在了一起，并且做了个压缩混淆，再放到生产目录。</p></li><li><p>webpack是用来打包所有的样式、js、图片等的工具。<br>众所周知，前端优化的一个重要原则，就是把这些资源打包得尽可能少，建立尽可能少的HTTP连接，这样就能够加速网页的加载。</p></li><li><p>因为构建工具不会永远不出问题，也不会永远满足需求，所以使用Node.js做JS构建工具，是最保险的选择。</p></li></ul><h3 id="4-3-开发工具visual-studio-code-nodejs的第三个应用场景"><a href="#4-3-开发工具visual-studio-code-nodejs的第三个应用场景" class="headerlink" title="4-3 开发工具visual studio code-nodejs的第三个应用场景"></a>4-3 开发工具visual studio code-nodejs的第三个应用场景</h3><h3 id="4-4-游戏-wayward"><a href="#4-4-游戏-wayward" class="headerlink" title="4-4 游戏-wayward"></a>4-4 游戏-wayward</h3><ul><li>它是一个沙盒类生存游戏，自由度非常高，即玩家想干嘛就干嘛，想使哪里就使哪里。</li><li>它也是基于Node.js的，为什么？<ol><li>像这种大型应用，都需要给使用者自定义模块的能力。</li><li>使用Node.js做复杂本地应用：<br>可以利用JS的灵活性提供外部扩展；<br>JS庞大的开发者技术让他们的灵活性得到利用。</li></ol></li></ul><h3 id="4-4-客户端应用-twitch-tv"><a href="#4-4-客户端应用-twitch-tv" class="headerlink" title="4-4 客户端应用-twitch-tv"></a>4-4 客户端应用-twitch-tv</h3><ul><li>它是个游戏直播网站，它也是用Node.js开发的，这是因为他们的网页和客户端应用是一模一样的。</li><li>他们需要在已有网站的情况下，新开发客户端应用，这就可以使用Node.js客户端技术（electron）实现，最大限度复用现有工程。</li></ul><h2 id="5-课程实战项目介绍"><a href="#5-课程实战项目介绍" class="headerlink" title="5 课程实战项目介绍"></a>5 课程实战项目介绍</h2><p>​ 这个项目是个Node.js版<a target="_blank" rel="noopener" href="https://time.geekbang.org/">极客时间网站</a>，包括一些典型的页面：</p><ol><li><p>列表页</p><img src="02.jpg" alt="02" style="zoom:67%"><ul><li><p>打通前后台通信<br>包括把浏览器地址栏传的参数都一一解析出来，然后传到后台的微服务去，等到后台的数据返回之后，我们再渲染成页面，返回到前端</p></li><li><p>服务端渲染<br>这个页面涉及比如下拉加载、过滤条件的变化等服务端渲染的功能</p></li></ul></li><li><p>详情页</p><img src="03.jpg" alt="03" style="zoom:80%"><ul><li>网页路由<br>HTTP服务器需要支持url路由，或者让Node.js前面加一项反向代理做路由，最终使Node.js能够支持列表页和详情页</li><li>异步加载</li></ul><p>涉及功能点还有课程介绍和课程目录在Node.js服务上实现无刷新切换。</p></li><li><p>播放页</p><p><img src="04.jpg" alt="04"></p><p><img src="05.jpg" alt="05"></p><ul><li>API服务器<br>评论系统点赞需要API服务器，实现小量的json数据的交换。</li></ul><p>涉及的功能点还有章节的选择等。</p></li></ol><h1 id="第二章-技术预研篇"><a href="#第二章-技术预研篇" class="headerlink" title="第二章 技术预研篇"></a>第二章 技术预研篇</h1><h2 id="6-什么是技术预研"><a href="#6-什么是技术预研" class="headerlink" title="6 什么是技术预研?"></a>6 什么是技术预研?</h2><ul><li>在程序开发前，把需要用到的技术和工具全都调试的没问题了再开发，这样使得开发技术变得更加顺利，这就是技术预研的作用。</li><li>具体怎样进行技术预研？<ol><li>分析要做的需求，找出技术难点。</li><li>针对每个技术难点进行攻克和测试。</li></ol></li><li>我们这个项目属于一个BFF层，通俗点讲，它属于浏览器跟后台服务中间的一个中间渲染层，这个中间渲染层则组装后台返回的各个微服务里面返回的数据，并且组装成前端所需要的数据，再返回到？</li><li>这样的BFF层的主要职责有两个：<ol><li>对用户侧提供HTTP服务</li><li>使用后端RPC服务</li></ol></li></ul><h2 id="7-nodejs开发环境安装"><a href="#7-nodejs开发环境安装" class="headerlink" title="7 nodejs开发环境安装"></a>7 nodejs开发环境安装</h2><ul><li>Chrome的安装</li><li>VSCode的安装</li><li>Node.js的安装<br>直接去<a target="_blank" rel="noopener" href="https://nodejs.org/en/">官网</a>下载安装</li><li>包管理工具npm的安装</li></ul><h2 id="8-第一个nodejs程序-石头剪刀布游戏"><a href="#8-第一个nodejs程序-石头剪刀布游戏" class="headerlink" title="8 第一个nodejs程序-石头剪刀布游戏"></a>8 第一个nodejs程序-石头剪刀布游戏</h2><h3 id="8-1-前言"><a href="#8-1-前言" class="headerlink" title="8-1 前言"></a>8-1 前言</h3><ul><li>在这个游戏中，我们会看到：<ol><li>Node.js的运行方式是怎样的</li><li>Node.js的全局变量是怎样使用的，以及它有哪些全局变量</li></ol></li><li>新建node_js文件夹，新建node_js/index.js文件，里面编写代码<code>console.log(&#39;hello world&#39;)</code>，并在终端打开项目，执行<code>$ node index.js</code>，就能看到hello world被打印出来。<br>这个node命令会读取index.js中的内容，并运行它里面的js代码。</li><li>Node.js的某些全局变量与Chrome里的有些差别，如：<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Date</span>)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">setTimeout</span>)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">setInterval</span>)</span><br><span class="line"><span class="built_in">console</span>.log(requestAnimationFrame) <span class="comment">// 它的含义是浏览器渲染的下一帧，由于我们不是处于浏览器环境，所以它是不存在的，会报错</span></span><br></pre></td></tr></table></figure>运行<code>$ node index.js</code>后的打印结果如下：<div><img src="06.jpg" alt="06" style="zoom:67%"></div>Node.js为了弥补requestAnimationFrame的确实，额外提供了一个：<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(setImmediate)</span><br></pre></td></tr></table></figure>打印结果为：<img src="07.jpg" alt="07" style="zoom:80%"></li><li>Node.js特有的环境变量：<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> <span class="built_in">console</span>.log(__filename) <span class="comment">// 表示当前运行的脚本所在的位置</span></span><br><span class="line"><span class="number">2.</span> <span class="built_in">console</span>.log(__dirname) <span class="comment">// 表示当前运行的脚本所在的目录位置</span></span><br></pre></td></tr></table></figure>打印结果为：<img src="08.jpg" alt="08" style="zoom:80%"><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">3.</span> <span class="built_in">console</span>.log(process) <span class="comment">// 记载了我们运行这个Node.js程序的进程信息</span></span><br></pre></td></tr></table></figure>打印结果为：<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">PS C:\studyFiles\node_js&gt; node index.js</span><br><span class="line">process &#123;</span><br><span class="line">    version: <span class="string">&#x27;v10.16.3&#x27;</span>,  <span class="comment">// 表示Node.js的版本号</span></span><br><span class="line">    platform: <span class="string">&#x27;win32&#x27;</span>,  <span class="comment">// 表示运行环境的操作系统</span></span><br><span class="line">    hrtime: &#123; [<span class="built_in">Function</span>: hrtime] bigint: [<span class="built_in">Function</span>] &#125;,  <span class="comment">// 是用来统计时间的，它的时间精度可以到微秒级，我们需要做时间统计时可以用这个函数</span></span><br><span class="line">    cpuUsage: [<span class="built_in">Function</span>: cpuUsage],  <span class="comment">// 打印cpu占用率</span></span><br><span class="line">    memoryUsage: [<span class="built_in">Function</span>: memoryUsage],  <span class="comment">// 打印内存占用率，与cpuUsage在性能分析时经常用到</span></span><br><span class="line">    exit: [<span class="built_in">Function</span>],</span><br><span class="line">    kill: [<span class="built_in">Function</span>],  <span class="comment">// 与exit是用来管理和杀进程的操作</span></span><br><span class="line">    argv: [   <span class="comment">// 表示用户在启动这个进程时，敲击的命令是怎样的，这个会在我们做命令行程序时用到</span></span><br><span class="line">        <span class="string">&#x27;C:\\dev\\nodejs\\node.exe&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;C:\\studyFiles\\node_js\\index.js&#x27;</span> </span><br><span class="line">    ],</span><br><span class="line">    env: &#123;  <span class="comment">// 打印Node目前所运行环境的环境变量，可以让我们在快速启动Node.js时做一些配置，让我们的程序可以根据环境变量做一些分析</span></span><br><span class="line">        Path: ...        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h3 id="8-2-利用process-argv正式编写石头剪刀布游戏"><a href="#8-2-利用process-argv正式编写石头剪刀布游戏" class="headerlink" title="8-2 利用process-argv正式编写石头剪刀布游戏"></a>8-2 利用process-argv正式编写石头剪刀布游戏</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> playerAction = process.argv[process.argv.length - <span class="number">1</span>]</span><br><span class="line"><span class="built_in">console</span>.log(playerAction)  <span class="comment">// 打印出node index.js rock的最后一项，即rock</span></span><br><span class="line"><span class="keyword">var</span> random = <span class="built_in">Math</span>.random() * <span class="number">3</span></span><br><span class="line"><span class="keyword">if</span>(random &lt; <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> computerAction = <span class="string">&#x27;rock&#x27;</span></span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(random &gt; <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> computerAction = <span class="string">&#x27;scissor&#x27;</span></span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">var</span> computerAction = <span class="string">&#x27;paper&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line"><span class="keyword">if</span>(computerAction === playerAction) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;平局&#x27;</span>)</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(</span><br><span class="line">    (computerAction === <span class="string">&#x27;rock&#x27;</span> &amp;&amp; playerAction === <span class="string">&#x27;paper&#x27;</span>) ||</span><br><span class="line">    (computerAction === <span class="string">&#x27;scissor&#x27;</span> &amp;&amp; playerAction === <span class="string">&#x27;rock&#x27;</span>) ||</span><br><span class="line">    (computerAction === <span class="string">&#x27;papar&#x27;</span> &amp;&amp; playerAction === <span class="string">&#x27;scissor&#x27;</span>)</span><br><span class="line">) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;你赢了&#x27;</span>)</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;你输了&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="9-模块-commonjs规范"><a href="#9-模块-commonjs规范" class="headerlink" title="9 模块-commonjs规范"></a>9 模块-commonjs规范</h2><ul><li>JS中采用<code>&lt;script /&gt;</code>加载js文件，它存在以下问题：<ol><li>脚本变多时，需要手动管理加载顺序。</li><li>不同脚本之间逻辑调用，需要通过全局变量的方式。<br>全局变量多了，程序就很难管理；而且全局变量还存在被别人覆盖的风险。</li><li>当JS运行环境没有html怎么办？</li></ol></li></ul><h3 id="9-1-commonjs规范的使用过程"><a href="#9-1-commonjs规范的使用过程" class="headerlink" title="9-1 commonjs规范的使用过程"></a>9-1 commonjs规范的使用过程</h3><ul><li><p>创建node_js/commonjs文件夹，并在它里面创建两个文件index.js和lib.js</p></li><li><p>编写index.js：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;start require&#x27;</span>)</span><br><span class="line"><span class="built_in">require</span>(<span class="string">&#x27;./lib.js&#x27;</span>)  <span class="comment">// 会根据CommonJS规范引入lib.js</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;end require&#x27;</span>)</span><br></pre></td></tr></table></figure><p>编写lib.js：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;hello gc&#x27;</span>)</span><br></pre></td></tr></table></figure><p>打印结果为：</p><img src="09.jpg" alt="09" style="zoom:80%"></li><li><p>当一个初始状态模块被别人引用后，它默认是一个空对象。比如，我们可以将index.js中的require的结果赋值到一个变量上，并打印出来看一下：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> lib = <span class="built_in">require</span>(<span class="string">&#x27;./lib.js&#x27;</span>)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;end require&#x27;</span>, lib)</span><br></pre></td></tr></table></figure><p>打印结果为：</p><img src="10.jpg" alt="10" style="zoom:80%"></li><li><p>我们可以在lib.js模块的exports上挂一个属性，再次打印看下结果：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// lib.js：</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;hello gc&#x27;</span>)</span><br><span class="line"><span class="built_in">exports</span>.hello = <span class="string">&#x27;world&#x27;</span></span><br><span class="line"><span class="comment">// index.js：</span></span><br><span class="line"><span class="keyword">var</span> lib = <span class="built_in">require</span>(<span class="string">&#x27;./lib.js&#x27;</span>)</span><br><span class="line"><span class="built_in">console</span>.log(lib)</span><br></pre></td></tr></table></figure><p>打印结果为：</p><img src="11.jpg" alt="11" style="zoom:80%"></li><li><p>exports上也可以挂函数、对象等：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">exports</span>.hello = <span class="string">&#x27;world&#x27;</span></span><br><span class="line"><span class="built_in">exports</span>.add = <span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a + b</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">exports</span>.geekbang = &#123; <span class="attr">hello</span>: <span class="string">&#x27;world&#x27;</span> &#125;</span><br></pre></td></tr></table></figure><p>打印结果为：</p><img src="12.jpg" alt="12" style="zoom:80%"></li><li><p>验证lib.js模块中exports出的对象与index.js中require的变量是同一个引用：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">index.js：</span><br><span class="line"><span class="keyword">var</span> lib = <span class="built_in">require</span>(<span class="string">&#x27;./lib.js&#x27;</span>)</span><br><span class="line">lib.additional = <span class="string">&#x27;test&#x27;</span></span><br><span class="line"></span><br><span class="line">lib.js：</span><br><span class="line"><span class="built_in">exports</span>.hello = <span class="string">&#x27;world&#x27;</span></span><br><span class="line"><span class="built_in">exports</span>.add = <span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a + b</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">exports</span>.geekbang = &#123; <span class="attr">hello</span>: <span class="string">&#x27;world&#x27;</span> &#125;</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">exports</span>)</span><br><span class="line">&#125;, <span class="number">2000</span>)</span><br></pre></td></tr></table></figure><p>2s后打印结果显示为：</p><img src="13.jpg" alt="13" style="zoom:80%"></li><li><p>假如希望exports不是一个对象，它可以是一个函数或其他基础数据类型</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// lib.js：</span></span><br><span class="line"><span class="built_in">exports</span>.hello = <span class="string">&#x27;world&#x27;</span></span><br><span class="line"><span class="built_in">exports</span>.add = <span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">exports</span>.geekbang = &#123; <span class="attr">hello</span>: <span class="string">&#x27;world&#x27;</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> <span class="title">minus</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a - b</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// index.js：</span></span><br><span class="line"><span class="keyword">var</span> lib = <span class="built_in">require</span>(<span class="string">&#x27;./lib.js&#x27;</span>)</span><br><span class="line"><span class="built_in">console</span>.log(lib)</span><br></pre></td></tr></table></figure><p>打印结果为：<img src="14.jpg" alt="14" style="zoom:80%"></p><blockquote><p>PS：无论lib.js中有没有exports其他的，打印结果都以module.exports为准，也可以理解为module.exports会把exports出的变量覆盖掉</p></blockquote></li><li><p>使用webpack打包会发现每个模块都被打包到一个函数里，这是因为每个模块都是一个独立的作用域，而js中创建独立作用域的方式就是采用函数（老师将的例子不懂！！！）</p></li></ul><h2 id="10-模块-使用模块规范改造石头剪刀布游戏"><a href="#10-模块-使用模块规范改造石头剪刀布游戏" class="headerlink" title="10 模块-使用模块规范改造石头剪刀布游戏"></a>10 模块-使用模块规范改造石头剪刀布游戏</h2><h3 id="10-1-改造石头剪刀布游戏"><a href="#10-1-改造石头剪刀布游戏" class="headerlink" title="10-1 改造石头剪刀布游戏"></a>10-1 改造石头剪刀布游戏</h3><ul><li>改造后的代码如下：<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// lib.js：</span></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span>(<span class="params">playerAction</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> random = <span class="built_in">Math</span>.random() * <span class="number">3</span></span><br><span class="line">    <span class="keyword">if</span>(random &lt; <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> computerAction = <span class="string">&#x27;rock&#x27;</span></span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(random &gt; <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> computerAction = <span class="string">&#x27;scissor&#x27;</span></span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> computerAction = <span class="string">&#x27;paper&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(computerAction === playerAction) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;平局&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(</span><br><span class="line">        (computerAction === <span class="string">&#x27;rock&#x27;</span> &amp;&amp; playerAction === <span class="string">&#x27;paper&#x27;</span>) ||</span><br><span class="line">        (computerAction === <span class="string">&#x27;scissor&#x27;</span> &amp;&amp; playerAction === <span class="string">&#x27;rock&#x27;</span>) ||</span><br><span class="line">        (computerAction === <span class="string">&#x27;papar&#x27;</span> &amp;&amp; playerAction === <span class="string">&#x27;scissor&#x27;</span>)</span><br><span class="line">    ) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;你赢了&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span></span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;你输了&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.js：       </span></span><br><span class="line"><span class="comment">// var playerAction = process.argv[process.argv.length - 1]</span></span><br><span class="line"><span class="keyword">const</span> game = <span class="built_in">require</span>(<span class="string">&#x27;./lib&#x27;</span>)</span><br><span class="line"><span class="comment">// const result = game(playerAction)</span></span><br><span class="line"><span class="comment">// console.log(result)</span></span><br><span class="line">process.stdin.on(<span class="string">&#x27;data&#x27;</span>, <span class="function"><span class="params">e</span> =&gt;</span> &#123;  <span class="comment">// 获取进程的标准输入</span></span><br><span class="line">    <span class="keyword">const</span> playerAction = e.toString().trim()  <span class="comment">// 并把这个标准输入转化成字符串输出出来</span></span><br><span class="line">    <span class="comment">// console.log(playerAction)</span></span><br><span class="line">    <span class="keyword">const</span> result = game(playerAction)</span><br><span class="line">    <span class="built_in">console</span>.log(result)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>运行命令<code>$ node index.js</code>后它会持续运行，输入命令后打印结果如下：<div><img src="15.jpg" alt="15" style="zoom:67%"></div></li><li>我们希望实现的需求是：电脑输三次就会自杀，代码紧接上面，改造index.js：<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> count = <span class="number">0</span></span><br><span class="line">process.stdin.on(<span class="string">&#x27;data&#x27;</span>, <span class="function"><span class="params">e</span> =&gt;</span> &#123;  <span class="comment">// 获取进程的标准输入</span></span><br><span class="line">    <span class="keyword">const</span> playerAction = e.toString().trim()  <span class="comment">// 并把这个标准输入转化成字符串输出出来</span></span><br><span class="line">    <span class="keyword">const</span> result = game(playerAction)</span><br><span class="line">    <span class="built_in">console</span>.log(result)</span><br><span class="line">    <span class="keyword">if</span>(result === -<span class="number">1</span>) &#123;</span><br><span class="line">        count ++</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(count === <span class="number">3</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;你太厉害了，我不玩了！&#x27;</span>)</span><br><span class="line">        process.exit()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>打印结果如下：<div><img src="16.jpg" alt="16" style="zoom:67%"></div></li></ul><h2 id="11-模块-npm"><a href="#11-模块-npm" class="headerlink" title="11 模块-npm"></a>11 模块-npm</h2><h3 id="11-1-npm介绍"><a href="#11-1-npm介绍" class="headerlink" title="11-1 npm介绍"></a>11-1 npm介绍</h3><ul><li>npm是什么？<br>Node.js的包管理工具</li><li>包是什么？<br>别人写的Node.js模块</li><li>npm上的著名大神：<br>TJ Holowaychunk - 贡献express包<br>Mafintosh<br>Dominictarr - npm event-stream事件</li><li>没有npm，也不会有现在这么繁荣的JS社区</li></ul><h3 id="11-2-怎么使用npm包呢"><a href="#11-2-怎么使用npm包呢" class="headerlink" title="11-2 怎么使用npm包呢?"></a>11-2 怎么使用npm包呢?</h3><ul><li>新建npm文件夹，并在其中运行命令<code>$ npm init</code>，问题一律选择默认，然后就会生成一个package.json，它是用来说明这个目录表达的是一个npm包，只要是npm包，就能装其他npm包</li><li>运行<code>$ npm install glob</code>安装glob包，就会生成node_modules目录，在package.json中多出dependencies依赖：<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;name&quot;</span>: <span class="string">&quot;npm&quot;</span>,</span><br><span class="line">  <span class="string">&quot;version&quot;</span>: <span class="string">&quot;1.0.0&quot;</span>,</span><br><span class="line">  <span class="string">&quot;description&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  <span class="string">&quot;main&quot;</span>: <span class="string">&quot;index.js&quot;</span>,</span><br><span class="line">  <span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;test&quot;</span>: <span class="string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;author&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  <span class="string">&quot;license&quot;</span>: <span class="string">&quot;ISC&quot;</span>,</span><br><span class="line">  <span class="string">&quot;dependencies&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;glob&quot;</span>: <span class="string">&quot;^7.1.6&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li>直接在国外网站下载npm包太慢，可以使用淘宝npm镜像<a target="_blank" rel="noopener" href="http://npm.taobao.org/">http://npm.taobao.org/</a>，它把国外的所有npm包复制映射过来，并放到国内的服务器中了。怎么使用呢？<ol><li><code>$ npm install -g cnpm --registry=https://registry.npm.taobao.org</code></li><li><code>$ cnpm install gulp --save</code></li></ol></li><li>关于npm的相关问题，可以登录查看<a target="_blank" rel="noopener" href="https://docs.npmjs.com/">官方文档</a></li></ul><h2 id="12-模块-nodejs内置模块"><a href="#12-模块-nodejs内置模块" class="headerlink" title="12 模块-nodejs内置模块"></a>12 模块-nodejs内置模块</h2><div style="padding-left:1em"><img src="17.jpg" alt="17" style="zoom:67%"><p>重申Node.js的官方定义：</p><p>1. Node.js是一个基于Chrome V8引擎的JavaScript运行环境（如图中左半部分） Application是我们所写的Node.js代码，它通过V8引擎运行，里面会涉及一些关于操作系统的调用，这部分就由V8引擎帮助转发到操作系统层面，从操作系统层面得到返回结果后，再通过V8引擎返回到JS中去。 从JS到V8再到操作系统的能力，有很大部分是由内置的模块提供的。</p><p>2. Node.js使用事件驱动，非阻塞式I/O的模型，使其轻量又高效（如图中右半部分）</p></div><h3 id="12-1-nodejs内置模块"><a href="#12-1-nodejs内置模块" class="headerlink" title="12-1 nodejs内置模块"></a>12-1 nodejs内置模块</h3><ul><li><a target="_blank" rel="noopener" href="https://nodejs.org/dist/latest-v12.x/docs/api/">官网</a>列出所有的内置模块，举例说明：<ol><li>File System - 用来操作文件的关于操作系统的api</li><li>Net - 让我们可以使用操作系统的网络能力</li><li>Process - 记载着Node.js进程的一些信息</li><li>OS - 表示跟操作系统相关的模块<ul><li>os.arch() 表明了操作系统的架构，如32位、64位</li><li>os.cpus() 得到node.js所运行的电脑里有多少cpu，以及cpu里有多少个内核，这些核的参数是怎样的</li><li>os.freemem() 表示当前的操作系统还有多少空余内存</li></ul></li></ol></li></ul><h3 id="12-2-剖析nodejs内置模块"><a href="#12-2-剖析nodejs内置模块" class="headerlink" title="12-2 剖析nodejs内置模块"></a>12-2 剖析nodejs内置模块</h3><ul><li>在<a target="_blank" rel="noopener" href="https://github.com/nodejs/node">github</a>上查看源码，所有的内置模块都在lib文件夹中，查看os.js</li><li>Node.js内置模块做的事情基本上是负责Node.js的应用层面到操作系统层面的通信，包括Node.js调用os的能力或者os通知Node.js的能力。<br>有了内置模块，Node.js就拥有了强大的和操作系统交互的能力，也就能顺利地做成服务端的应用。</li></ul><h3 id="12-3-event-emitter"><a href="#12-3-event-emitter" class="headerlink" title="12-3 event-emitter"></a>12-3 event-emitter</h3><ul><li>观察者模式，即事件收发的模式，用来解决两个对象之间通信的问题，如addEventListener和removeEventListener<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// lib.js:</span></span><br><span class="line"><span class="keyword">const</span> EventEmitter = <span class="built_in">require</span>(<span class="string">&#x27;events&#x27;</span>).EventEmitter</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Geektime</span> <span class="keyword">extends</span> <span class="title">EventEmitter</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="title">constructor</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>()</span><br><span class="line">        <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.emit(<span class="string">&#x27;newLession&#x27;</span>, &#123; <span class="attr">price</span>: <span class="built_in">Math</span>.random() * <span class="number">100</span> &#125;)</span><br><span class="line">        &#125;, <span class="number">3000</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> geektime = <span class="keyword">new</span> Geektime</span><br><span class="line"><span class="built_in">module</span>.exports = geektime</span><br><span class="line"></span><br><span class="line"><span class="comment">// index.js：</span></span><br><span class="line"><span class="keyword">const</span> geektime = <span class="built_in">require</span>(<span class="string">&#x27;./lib&#x27;</span>)</span><br><span class="line">geektime.addListener(<span class="string">&#x27;newLession&#x27;</span>, <span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 业务代码</span></span><br><span class="line">    <span class="keyword">if</span>(res.price &lt; <span class="number">80</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;buy it&#x27;</span>, res)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><blockquote><p>EverntEmitter的实例可以抛任意的事件出来，并且带着它想要的参数。<br>我们可以把底层的逻辑封装起来，放在某个模块里如lib.js，外面的业务代码拿到这个模块，通过事件的监听器就能方便地知道子模块里面发生的变化，这种变化并不需要geektime调用里面的函数，只需要它往自己身上抛一个事件即可。<br>这就是设计模式想要达到的目的，即扩展一些逻辑，完全不需要改动底层，就能提高程序的可维护性。</p></blockquote></li><li>调用vs抛事件<br>比如老板通知秘书做某事，做好的方式还是调用，因为观察者模式抛事件的方式最适用的场景在于“不知道被通知者存在”以及“没有人监听还能继续下去”。</li></ul><h3 id="12-4-总结"><a href="#12-4-总结" class="headerlink" title="12-4 总结"></a>12-4 总结</h3><p>​ 经过模块这部分的研究，我们明确了Node.js的其中一个特点，就是它是一门具备可扩展性的全面的能在服务端运行的js技术。</p><h2 id="13-异步-非阻塞i-o"><a href="#13-异步-非阻塞i-o" class="headerlink" title="13 异步-非阻塞i /o"></a>13 异步-非阻塞i /o</h2><h3 id="13-1-非阻塞i-o的定义"><a href="#13-1-非阻塞i-o的定义" class="headerlink" title="13-1 非阻塞i /o的定义"></a>13-1 非阻塞i /o的定义</h3><ul><li>I/O即Input/Output，它指代一个系统的输入和输出</li><li>阻塞I/O和非阻塞I/O的区别就在于<strong>系统接收输入再到输出期间，能不能接收其他输入</strong><br>【例1】排队打饭vs餐厅点菜<br>对于点菜人员来说，排队打饭是阻塞I/O，餐厅点菜是非阻塞I/O<br>系统=食堂阿姨/服务生，输入=点菜，输出=端菜<br>饭堂阿姨只能一份一份饭地打-&gt;阻塞I/O<br>服务生点完菜之后可以服务其他客人-&gt;非阻塞I/O<br>【例2】在Node.js论坛提问题：“这个Node.js问题怎么解决？在线等，急”<br>这也是个阻塞I/O的例子，因为在提问后到得到答案前什么都做不了，只能f5；<br>但是如果你提问后就去忙其他的了，待会再回来看是否有人回答，就是非阻塞I/O了。<blockquote><p>综上说明，为什么非阻塞I/O能得到性能的提升，是因为它能把不必要的等待省略掉。</p></blockquote></li><li>理解非阻塞I/O的要点在于：<ol><li>确定一个进行Input/Output的系统。</li><li>思考在I/O过程中，能不能进行其他I/O。</li></ol></li></ul><h3 id="13-2-非阻塞i-o代码演示"><a href="#13-2-非阻塞i-o代码演示" class="headerlink" title="13-2 非阻塞i /o代码演示"></a>13-2 非阻塞i /o代码演示</h3><ul><li>新建目录nonblocking，在里面新建index.js，并运行<code>$ npm init</code>，安装glob包<code>$ npm install glob</code>。<br>glob包的作用是能把目录下的所有文件和文件名递归地获取到。</li><li>index.js中阻塞I/O代码如下：<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> glob = <span class="built_in">require</span>(<span class="string">&#x27;glob&#x27;</span>)</span><br><span class="line"><span class="keyword">let</span> result = <span class="literal">null</span></span><br><span class="line"><span class="built_in">console</span>.time(<span class="string">&#x27;glob&#x27;</span>)</span><br><span class="line">result = glob.sync(__dirname + <span class="string">&#x27;/**/*&#x27;</span>)</span><br><span class="line"><span class="built_in">console</span>.timeEnd(<span class="string">&#x27;glob&#x27;</span>)</span><br><span class="line"><span class="built_in">console</span>.log(result)</span><br></pre></td></tr></table></figure>打印结果及操作耗时如下： <img src="18.jpg" alt="18" style="zoom:80%"></li><li>index.js中非阻塞I/O代码如下：<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> glob = <span class="built_in">require</span>(<span class="string">&#x27;glob&#x27;</span>)</span><br><span class="line"><span class="keyword">let</span> result = <span class="literal">null</span></span><br><span class="line"><span class="built_in">console</span>.time(<span class="string">&#x27;glob&#x27;</span>)</span><br><span class="line">glob(__dirname + <span class="string">&#x27;/**/*&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">err, res</span>) </span>&#123;</span><br><span class="line">    result = res</span><br><span class="line">    <span class="comment">// console.log(result)</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;got result&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.timeEnd(<span class="string">&#x27;glob&#x27;</span>)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">1</span> + <span class="number">1</span>)</span><br></pre></td></tr></table></figure>打印结果及操作耗时如下： <img src="19.jpg" alt="19" style="zoom:80%"></li><li>通过以上的代码演示，我们发现：<br>非阻塞I/O比阻塞I/O的耗时缩短了许多，减少了node.js的等待时间；<br>非阻塞I/O在glob方法回调前，就先执行了1+1计算，等glob方法有了结果，才打印出相应的结果。</li></ul><h3 id="13-3-nodejs架构图讲解"><a href="#13-3-nodejs架构图讲解" class="headerlink" title="13-3 nodejs架构图讲解"></a>13-3 nodejs架构图讲解</h3><div style="padding-left:5px"><img src="20.jpg" alt="20" style="zoom:67%"></div><ul><li>图中是按照线程重新划分，蓝框左半部分都是Node.js线程，它的所有I/O操作都是非阻塞的，它会把大量的计算能力分发到其他的C++线程去计算，等到其他C++线程把计算都执行完毕后，再把结果回调到Node.js线程，Node.js线程再把这个结果返回给应用程序。</li><li>LIBUV是实现Node.js非阻塞I/O的核心模块</li></ul><h2 id="14-异步-异步编程之callback"><a href="#14-异步-异步编程之callback" class="headerlink" title="14 异步-异步编程之callback"></a>14 异步-异步编程之callback</h2><h3 id="14-1-回调函数"><a href="#14-1-回调函数" class="headerlink" title="14-1 回调函数"></a>14-1 回调函数</h3><ul><li>Node.js中的回调函数有一定的格式规范，叫做error-first callback或Node-style callback。含义是所有的callback函数都要遵循这个参数格式，即第一个参数是error，剩余的参数才是这个回调函数的执行结果。</li></ul><p>未完待续……</p></div><div class="article-footer"><blockquote class="mt-2x"><ul class="post-copyright list-unstyled"><li class="post-copyright-link hidden-xs"><strong>本文链接：</strong> <a href="https://scarlett9354.github.io/2021/04/29/Node-js%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98/" title="Node.js开发实战" target="_blank" rel="external">https://scarlett9354.github.io/2021/04/29/Node-js%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98/</a></li><li class="post-copyright-license"><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN协议</a> 许可协议。转载请注明出处！</li></ul></blockquote><div class="panel panel-default panel-badger"><div class="panel-body"><figure class="media"><div class="media-left"><a href="https://github.com/scarlett9354" target="_blank" class="img-burn thumb-sm visible-lg"><img src="/images/avatar.jpg" class="img-rounded w-full" alt=""></a></div><div class="media-body"><h3 class="media-heading"><a href="https://github.com/scarlett9354" target="_blank"><span class="text-dark">月亮和水蜜桃</span><small class="ml-1x"></small></a></h3><div>后悔和不甘心是比恐惧还要糟糕无数倍的事情</div></div></figure></div></div></div></article><section id="comments"><div id="vcomments"></div></section></div><nav class="bar bar-footer clearfix" data-stick-bottom><div class="bar-inner"><ul class="pager pull-left"><li class="prev"><a href="/2021/04/29/%E5%89%8D%E7%AB%AF%E5%85%A8%E9%93%BE%E8%B7%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98/" title="前端全链路性能优化实战"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;上一篇</span></a></li><li class="next"><a href="/2021/04/29/TypeScript%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98/" title="TypeScript开发实战"><span>下一篇&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a></li></ul><button type="button" class="btn btn-fancy btn-donate pop-onhover bg-gradient-warning" data-toggle="modal" data-target="#donateModal"><span>赏</span></button><div class="bar-right"><div class="share-component" data-sites="weibo,qq,wechat,facebook,twitter" data-mobile-sites="weibo,qq,qzone"></div></div></div></nav><div class="modal modal-center modal-small modal-xs-full fade" id="donateModal" tabindex="-1" role="dialog"><div class="modal-dialog" role="document"><div class="modal-content donate"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><div class="modal-body"><div class="donate-box"><div class="donate-head"><p>感谢您的支持，我会继续努力的!</p></div><div class="tab-content"><div role="tabpanel" class="tab-pane fade active in" id="alipay"><div class="donate-payimg"><img src="/images/donate/alipayimg.jpg" alt="扫码支持" title="扫一扫"></div><p class="text-muted mv">扫码打赏，你说多少就多少</p><p class="text-grey">打开支付宝扫一扫，即可进行扫码打赏哦</p></div><div role="tabpanel" class="tab-pane fade" id="wechatpay"><div class="donate-payimg"><img src="/images/donate/wechatpayimg.jpg" alt="扫码支持" title="扫一扫"></div><p class="text-muted mv">扫码打赏，你说多少就多少</p><p class="text-grey">打开微信扫一扫，即可进行扫码打赏哦</p></div></div><div class="donate-footer"><ul class="nav nav-tabs nav-justified" role="tablist"><li role="presentation" class="active"><a href="#alipay" id="alipay-tab" role="tab" data-toggle="tab" aria-controls="alipay" aria-expanded="true"><i class="icon icon-alipay"></i> 支付宝</a></li><li role="presentation"><a href="#wechatpay" role="tab" id="wechatpay-tab" data-toggle="tab" aria-controls="wechatpay" aria-expanded="false"><i class="icon icon-wepay"></i> 微信支付</a></li></ul></div></div></div></div></div></div></main><footer class="footer" itemscope itemtype="http://schema.org/WPFooter"><ul class="social-links"><li><a href="https://github.com/scarlett9354" target="_blank" title="Github" data-toggle="tooltip" data-placement="top"><i class="icon icon-github"></i></a></li></ul><div class="copyright"><div class="publishby">Theme by <a href="https://github.com/scarlett9354" target="_blank">cofess </a>base on <a href="https://github.com/scarlett9354" target="_blank">pure</a>.</div></div></footer><script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script><script>window.jQuery||document.write('<script src="js/jquery.min.js"><\/script>')</script><script src="/js/plugin.min.js"></script><script src="/js/application.js"></script><script>window.INSIGHT_CONFIG={TRANSLATION:{POSTS:"文章",PAGES:"页面",CATEGORIES:"分类",TAGS:"标签",UNTITLED:"(未命名)"},ROOT_URL:"/",CONTENT_URL:"/content.json"}</script><script src="/js/insight.js"></script><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><script type="text/javascript">var GUEST=["nick","mail","link"],meta=(meta="nick,mail,link").split(",").filter(function(e){return-1<GUEST.indexOf(e)});new Valine({el:"#vcomments",verify:!1,notify:!1,appId:"CGfXhVCqWm4TdYv6umPBwwxl-gzGzoHsz",appKey:"HiydsvsidPpjPqThgYUNvepU",placeholder:"Just go go",avatar:"mm",meta:meta,pageSize:"10",visitor:!1})</script></body></html>